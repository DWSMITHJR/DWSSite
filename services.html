<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Our Services - DWS</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <style>
        .service-card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            height: 100%;
        }
        .service-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
        }
        .service-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            color: #0d6efd;
        }
        .hero-section {
            background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
            color: white;
            padding: 4rem 0;
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="index.html">DWS</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="about.html">About</a></li>
                    <li class="nav-item"><a class="nav-link active" href="services.html">Services</a></li>
                    <li class="nav-item"><a class="nav-link" href="solutions.html">Solutions</a></li>
                    <li class="nav-item"><a class="nav-link" href="contact.html">Contact</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="hero-section text-center">
        <div class="container">
            <h1 class="display-4 fw-bold">Our Services</h1>
            <p class="lead">Delivering innovative solutions for your business needs</p>
        </div>
    </section>

    <!-- Services Section -->
    <section class="py-5">
        <div class="container">
            <div class="row g-4">
                <!-- Service 1 -->
                <div class="col-md-4">
                    <div class="card service-card h-100 p-4">
                        <div class="text-center">
                            <i class="bi bi-laptop service-icon"></i>
                            <h3>Web Development</h3>
                        </div>
                        <p>Custom web applications built with the latest technologies to help your business grow online. We create responsive, fast, and secure websites.</p>
                        <ul class="list-unstyled">
                            <li><i class="bi bi-check-circle text-success me-2"></i>Responsive Design</li>
                            <li><i class="bi bi-check-circle text-success me-2"></i>E-commerce Solutions</li>
                            <li><i class="bi bi-check-circle text-success me-2"></i>Content Management</li>
                        </ul>
                    </div>
                </div>

                <!-- Service 2 -->
                <div class="col-md-4">
                    <div class="card service-card h-100 p-4">
                        <div class="text-center">
                            <i class="bi bi-phone service-icon"></i>
                            <h3>Mobile Solutions</h3>
                        </div>
                        <p>Native and cross-platform mobile applications that provide seamless user experiences across all devices and platforms.</p>
                        <ul class="list-unstyled">
                            <li><i class="bi bi-check-circle text-success me-2"></i>iOS & Android Apps</li>
                            <li><i class="bi bi-check-circle text-success me-2"></i>Hybrid Applications</li>
                            <li><i class="bi bi-check-circle text-success me-2"></i>UI/UX Design</li>
                        </ul>
                    </div>
                </div>

                <!-- Service 3 -->
                <div class="col-md-4">
                    <div class="card service-card h-100 p-4">
                        <div class="text-center">
                            <i class="bi bi-cloud service-icon"></i>
                            <h3>Cloud Services</h3>
                        </div>
                        <p>Scalable cloud solutions to optimize your business operations and reduce infrastructure costs.</p>
                        <ul class="list-unstyled">
                            <li><i class="bi bi-check-circle text-success me-2"></i>Cloud Migration</li>
                            <li><i class="bi bi-check-circle text-success me-2"></i>Serverless Architecture</li>
                            <li><i class="bi bi-check-circle text-success me-2"></i>DevOps & CI/CD</li>
                        </ul>
                    </div>
                </div>

                <!-- Service 4 -->
                <div class="col-md-4 mt-4">
                    <div class="card service-card h-100 p-4">
                        <div class="text-center">
                            <i class="bi bi-shield-check service-icon"></i>
                            <h3>Security</h3>
                        </div>
                        <p>Comprehensive security solutions to protect your business from digital threats and ensure compliance.</p>
                        <ul class="list-unstyled">
                            <li><i class="bi bi-check-circle text-success me-2"></i>Security Audits</li>
                            <li><i class="bi bi-check-circle text-success me-2"></i>Data Protection</li>
                            <li><i class="bi bi-check-circle text-success me-2"></i>Compliance Consulting</li>
                        </ul>
                    </div>
                </div>

                <!-- Service 5 -->
                <div class="col-md-4 mt-4">
                    <div class="card service-card h-100 p-4">
                        <div class="text-center">
                            <i class="bi bi-graph-up service-icon"></i>
                            <h3>Analytics</h3>
                        </div>
                        <p>Data-driven insights to help you make informed business decisions and improve performance.</p>
                        <ul class="list-unstyled">
                            <li><i class="bi bi-check-circle text-success me-2"></i>Business Intelligence</li>
                            <li><i class="bi bi-check-circle text-success me-2"></i>Data Visualization</li>
                            <li><i class="bi bi-check-circle text-success me-2"></i>Performance Metrics</li>
                        </ul>
                    </div>
                </div>

                <!-- Service 6 -->
                <div class="col-md-4 mt-4">
                    <div class="card service-card h-100 p-4">
                        <div class="text-center">
                            <i class="bi bi-headset service-icon"></i>
                            <h3>Support</h3>
                        </div>
                        <p>24/7 technical support and maintenance services to keep your systems running smoothly.</p>
                        <ul class="list-unstyled">
                            <li><i class="bi bi-check-circle text-success me-2"></i>24/7 Monitoring</li>
                            <li><i class="bi bi-check-circle text-success me-2"></i>Technical Support</li>
                            <li><i class="bi bi-check-circle text-success me-2"></i>System Maintenance</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- CTA Section -->
    <section class="bg-light py-5">
        <div class="container text-center">
            <h2>Ready to get started?</h2>
            <p class="lead mb-4">Contact us today to discuss how we can help your business grow.</p>
            <a href="contact.html" class="btn btn-primary btn-lg">Get in Touch</a>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-dark text-white py-4">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <h5>DWS Solutions</h5>
                    <p>Innovative technology solutions for modern businesses.</p>
                </div>
                <div class="col-md-3">
                    <h5>Quick Links</h5>
                    <ul class="list-unstyled">
                        <li><a href="about.html" class="text-white">About Us</a></li>
                        <li><a href="services.html" class="text-white">Services</a></li>
                        <li><a href="solutions.html" class="text-white">Solutions</a></li>
                        <li><a href="contact.html" class="text-white">Contact</a></li>
                    </ul>
                </div>
                <div class="col-md-3">
                    <h5>Connect</h5>
                    <div class="d-flex gap-3">
                        <a href="#" class="text-white"><i class="bi bi-facebook"></i></a>
                        <a href="#" class="text-white"><i class="bi bi-twitter"></i></a>
                        <a href="#" class="text-white"><i class="bi bi-linkedin"></i></a>
                        <a href="#" class="text-white"><i class="bi bi-github"></i></a>
                    </div>
                </div>
            </div>
            <hr>
            <div class="text-center">
                <p class="mb-0">&copy; 2023 DWS. All rights reserved. | <a href="privacy.html" class="text-white">Privacy Policy</a> | <a href="terms.html" class="text-white">Terms of Service</a></p>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Server Events Demo Section -->
    <section id="server-events" class="py-5 bg-light" aria-labelledby="server-events-heading">
        <div class="container">
            <div class="text-center mb-5">
                <h2 id="server-events-heading" class="fw-bold">Real-time Server Events</h2>
                <p class="lead">Monitor and interact with server events in real-time</p>
            </div>
            
            <div class="row">
                <div class="col-lg-10 mx-auto">
                    <div class="card shadow-sm">
                        <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
                            <h3 class="h5 mb-0">Server Events Console</h3>
                            <div>
                                <span id="connection-status" class="badge bg-danger" role="status" aria-live="polite">Disconnected</span>
                                <span id="event-count" class="badge bg-secondary">0 Events</span>
                            </div>
                        </div>
                        <div class="card-body p-0">
                            <div id="console-output" class="console-output" role="log" aria-live="polite" aria-atomic="false">
                                <div class="text-muted p-3">
                                    <div class="spinner-border spinner-border-sm me-2" role="status">
                                        <span class="visually-hidden">Loading...</span>
                                    </div>
                                    Connecting to server events...
                                </div>
                            </div>
                        </div>
                        <div class="card-footer">
                            <div class="input-group">
                                <label for="event-name" class="visually-hidden">Event name</label>
                                <input type="text" id="event-name" class="form-control" placeholder="Event name" value="message" 
                                       aria-label="Event name" required>
                                <label for="event-data" class="visually-hidden">Event data</label>
                                <input type="text" id="event-data" class="form-control" placeholder="Event data" 
                                       aria-label="Event data" required>
                                <button id="send-event" class="btn btn-primary" disabled
                                        aria-label="Send event">
                                    <i class="bi bi-send" aria-hidden="true"></i> Send
                                </button>
                            </div>
                            <div class="mt-2 d-flex gap-2 flex-wrap" role="toolbar" aria-label="Quick actions">
                                <button class="btn btn-sm btn-outline-secondary quick-event" 
                                        data-event="user_joined" 
                                        data-data="New user connected"
                                        aria-label="Send user joined event">
                                    <i class="bi bi-person-plus" aria-hidden="true"></i> User Joined
                                </button>
                                <button class="btn btn-sm btn-outline-primary quick-event" 
                                        data-event="notification" 
                                        data-data="New notification received"
                                        aria-label="Send notification event">
                                    <i class="bi bi-bell" aria-hidden="true"></i> Notification
                                </button>
                                <button class="btn btn-sm btn-outline-warning quick-event" 
                                        data-event="system" 
                                        data-data="System update in progress..."
                                        aria-label="Send system update event">
                                    <i class="bi bi-gear" aria-hidden="true"></i> System Update
                                </button>
                                <button id="clear-events" class="btn btn-sm btn-outline-danger ms-auto"
                                        aria-label="Clear console">
                                    <i class="bi bi-trash" aria-hidden="true"></i> Clear
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Error Modal -->
    <div class="modal fade" id="errorModal" tabindex="-1" aria-labelledby="errorModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-danger text-white">
                    <h5 class="modal-title" id="errorModalLabel">Connection Error</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body" id="errorModalBody">
                    <!-- Error message will be inserted here -->
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" id="retry-connection">
                        <span class="spinner-border spinner-border-sm d-none" role="status" aria-hidden="true"></span>
                        Retry Connection
                    </button>
                </div>
            </div>
        </div>
    </div>

    <style>
        .console-output {
            height: 300px;
            overflow-y: auto;
            background-color: #1e1e1e;
            color: #d4d4d4;
            font-family: 'Consolas', 'Courier New', monospace;
            padding: 1rem;
            scrollbar-width: thin;
            scrollbar-color: #495057 #1e1e1e;
        }
        
        .console-output::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        .console-output::-webkit-scrollbar-track {
            background: #1e1e1e;
        }
        
        .console-output::-webkit-scrollbar-thumb {
            background-color: #495057;
            border-radius: 4px;
        }
        
        .console-line {
            margin-bottom: 0.5rem;
            line-height: 1.5;
            border-bottom: 1px solid #2d2d2d;
            padding-bottom: 0.5rem;
            font-size: 0.9rem;
            word-break: break-word;
        }
        
        .console-line:last-child {
            border-bottom: none;
        }
        
        .badge {
            font-family: inherit;
        }
        
        #server-events {
            background-color: #f8f9fa;
        }
        
        @media (max-width: 768px) {
            .console-output {
                height: 200px;
            }
            
            .input-group {
                flex-direction: column;
            }
            
            .input-group > *:not(:last-child) {
                margin-bottom: 0.5rem;
            }
        }
    </style>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // DOM Elements
            const consoleOutput = document.getElementById('console-output');
            const connectionStatus = document.getElementById('connection-status');
            const eventCount = document.getElementById('event-count');
            const sendButton = document.getElementById('send-event');
            const eventNameInput = document.getElementById('event-name');
            const eventDataInput = document.getElementById('event-data');
            const clearButton = document.getElementById('clear-events');
            const quickEventButtons = document.querySelectorAll('.quick-event');
            const errorModal = new bootstrap.Modal(document.getElementById('errorModal'));
            const errorModalBody = document.getElementById('errorModalBody');
            const retryButton = document.getElementById('retry-connection');
            
            // State
            let eventSource = null;
            let eventsReceived = 0;
            let reconnectAttempts = 0;
            const maxReconnectAttempts = 5;
            const reconnectDelay = 3000; // 3 seconds
            const clientId = 'client-' + Math.random().toString(36).substr(2, 8);
            
            // Initialize connection
            initializeConnection();
            
            // Event Delegation for dynamic elements
            document.addEventListener('click', function(e) {
                // Handle quick event buttons
                if (e.target.closest('.quick-event')) {
                    const button = e.target.closest('.quick-event');
                    eventNameInput.value = button.dataset.event;
                    eventDataInput.value = button.dataset.data;
                    sendEvent(button.dataset.event, button.dataset.data);
                }
            });
            
            // Event Listeners
            sendButton.addEventListener('click', handleSendEvent);
            eventDataInput.addEventListener('keypress', (e) => e.key === 'Enter' && handleSendEvent());
            clearButton.addEventListener('click', clearEvents);
            retryButton.addEventListener('click', handleRetryConnection);
            
            // Initialize the connection
            function initializeConnection() {
                try {
                    // Close existing connection if any
                    if (eventSource) {
                        eventSource.close();
                    }
                    
                    updateConnectionStatus('Connecting...', 'warning');
                    
                    const url = new URL(`api/serverevents/connect/${clientId}?group=services`, window.location.origin);
                    eventSource = new EventSource(url);
                    
                    // Connection established
                    eventSource.onopen = () => {
                        updateConnectionStatus('Connected', 'success');
                        reconnectAttempts = 0; // Reset reconnect attempts on successful connection
                        addEvent('system', 'Connected to server');
                    };
                    
                    // Error handling
                    eventSource.onerror = (error) => {
                        const errorMessage = 'Connection error. ' + 
                            (navigator.onLine ? 'Server may be down.' : 'No internet connection.');
                        
                        updateConnectionStatus('Disconnected', 'danger');
                        addEvent('error', errorMessage);
                        
                        // Try to reconnect if we're under the max attempts
                        if (reconnectAttempts < maxReconnectAttempts) {
                            reconnectAttempts++;
                            const delay = reconnectDelay * reconnectAttempts;
                            addEvent('system', `Attempting to reconnect (${reconnectAttempts}/${maxReconnectAttempts}) in ${delay/1000}s...`);
                            
                            setTimeout(() => {
                                initializeConnection();
                            }, delay);
                        } else {
                            showErrorModal('Failed to connect to the server. Please check your connection and try again.');
                        }
                    };
                    
                    // Message handler
                    eventSource.onmessage = (e) => {
                        try {
                            const data = JSON.parse(e.data);
                            addEvent(data.event || 'message', data.data || 'No data');
                        } catch (error) {
                            addEvent('message', e.data);
                        }
                    };
                    
                    // Custom event handlers
                    const eventTypes = ['notification', 'system', 'error'];
                    eventTypes.forEach(type => {
                        eventSource.addEventListener(type, (e) => {
                            addEvent(type, e.data);
                        });
                    });
                    
                } catch (error) {
                    console.error('Connection error:', error);
                    updateConnectionStatus('Connection Failed', 'danger');
                    addEvent('error', `Connection error: ${error.message}`);
                    showErrorModal(`Failed to connect: ${error.message}`);
                }
            }
            
            // Handle send event
            async function handleSendEvent() {
                const name = eventNameInput.value.trim();
                const data = eventDataInput.value.trim();
                
                if (!name) {
                    showError('Event name is required');
                    eventNameInput.focus();
                    return;
                }
                
                if (!data) {
                    showError('Event data is required');
                    eventDataInput.focus();
                    return;
                }
                
                const success = await sendEvent(name, data);
                if (success) {
                    eventDataInput.value = '';
                    eventDataInput.focus();
                }
            }
            
            // Send event to server
            async function sendEvent(eventName, eventData) {
                if (!eventName || !eventData) return false;
                
                const buttonText = sendButton.innerHTML;
                sendButton.disabled = true;
                sendButton.innerHTML = '<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Sending...';
                
                try {
                    const response = await fetch('api/serverevents/broadcast', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            EventName: eventName,
                            Data: eventData,
                            Group: 'services',
                            ClientId: clientId
                        })
                    });
                    
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    
                    addEvent('sent', `${eventName}: ${eventData}`);
                    return true;
                    
                } catch (error) {
                    console.error('Error sending event:', error);
                    addEvent('error', `Failed to send event: ${error.message}`);
                    showError(`Failed to send event: ${error.message}`);
                    return false;
                    
                } finally {
                    sendButton.disabled = false;
                    sendButton.innerHTML = buttonText;
                }
            }
            
            // Add event to console
            function addEvent(eventType, data) {
                const now = new Date();
                const timeString = now.toLocaleTimeString() + '.' + now.getMilliseconds().toString().padStart(3, '0');
                
                // Create message element
                const eventElement = document.createElement('div');
                eventElement.className = 'console-line';
                eventElement.innerHTML = `
                    <span class="text-muted">${timeString}</span>
                    <span class="badge bg-${getBadgeColor(eventType)}">${escapeHtml(eventType)}</span>
                    <span>${formatData(data)}</span>
                `;
                
                // Add to console
                consoleOutput.appendChild(eventElement);
                
                // Auto-scroll to bottom
                consoleOutput.scrollTop = consoleOutput.scrollHeight;
                
                // Update event counter
                eventsReceived++;
                eventCount.textContent = `${eventsReceived} Event${eventsReceived !== 1 ? 's' : ''}`;
                
                // Keep only the last 100 events
                while (consoleOutput.children.length > 100) {
                    consoleOutput.removeChild(consoleOutput.firstChild);
                }
            }
            
            // Clear all events
            function clearEvents() {
                consoleOutput.innerHTML = '<div class="text-muted p-3">Console cleared</div>';
                eventsReceived = 0;
                eventCount.textContent = '0 Events';
            }
            
            // Update connection status
            function updateConnectionStatus(status, type) {
                const statusMap = {
                    'Connecting...': 'warning',
                    'Connected': 'success',
                    'Disconnected': 'danger',
                    'Connection Failed': 'danger'
                };
                
                const badgeClass = `bg-${statusMap[status] || 'secondary'}`;
                connectionStatus.className = `badge ${badgeClass}`;
                connectionStatus.textContent = status;
                sendButton.disabled = status !== 'Connected';
                
                // Update ARIA live region
                const statusMessage = `Connection status: ${status}`;
                const statusElement = document.createElement('div');
                statusElement.className = 'visually-hidden';
                statusElement.setAttribute('aria-live', 'polite');
                statusElement.textContent = statusMessage;
                document.body.appendChild(statusElement);
                
                // Remove the element after a short delay
                setTimeout(() => {
                    document.body.removeChild(statusElement);
                }, 1000);
            }
            
            // Show error message
            function showError(message) {
                const errorElement = document.createElement('div');
                errorElement.className = 'alert alert-danger alert-dismissible fade show';
                errorElement.role = 'alert';
                errorElement.innerHTML = `
                    ${message}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                `;
                
                // Insert at the beginning of the console
                if (consoleOutput.firstChild) {
                    consoleOutput.insertBefore(errorElement, consoleOutput.firstChild);
                } else {
                    consoleOutput.appendChild(errorElement);
                }
                
                // Auto-remove after 5 seconds
                setTimeout(() => {
                    if (errorElement.parentNode === consoleOutput) {
                        consoleOutput.removeChild(errorElement);
                    }
                }, 5000);
            }
            
            // Show error modal
            function showErrorModal(message) {
                errorModalBody.textContent = message;
                errorModal.show();
            }
            
            // Handle retry connection
            function handleRetryConnection() {
                const spinner = retryButton.querySelector('.spinner-border');
                const buttonText = retryButton.querySelector('span:not(.spinner-border)');
                
                // Show spinner and disable button
                spinner.classList.remove('d-none');
                retryButton.disabled = true;
                
                // Try to reconnect
                initializeConnection();
                
                // Hide spinner and enable button after a delay
                setTimeout(() => {
                    spinner.classList.add('d-none');
                    retryButton.disabled = false;
                    errorModal.hide();
                }, 2000);
            }
            
            // Helper function to get badge color based on event type
            function getBadgeColor(eventType) {
                const colors = {
                    'error': 'danger',
                    'warning': 'warning',
                    'success': 'success',
                    'info': 'info',
                    'notification': 'primary',
                    'system': 'secondary',
                    'message': 'dark',
                    'sent': 'success'
                };
                return colors[eventType.toLowerCase()] || 'secondary';
            }
            
            // Format data for display
            function formatData(data) {
                if (typeof data === 'object') {
                    try {
                        return JSON.stringify(data, null, 2);
                    } catch (e) {
                        return String(data);
                    }
                }
                return String(data);
            }
            
            // Helper function to escape HTML
            function escapeHtml(unsafe) {
                if (!unsafe) return '';
                return unsafe
                    .replace(/&/g, '&amp;')
                    .replace(/</g, '&lt;')
                    .replace(/>/g, '&gt;')
                    .replace(/"/g, '&quot;')
                    .replace(/'/g, '&#039;');
            }
            
            // Clean up on page unload
            window.addEventListener('beforeunload', () => {
                if (eventSource) {
                    eventSource.close();
                }
            });
            
            // Handle page visibility changes
            document.addEventListener('visibilitychange', () => {
                if (document.visibilityState === 'visible' && !eventSource) {
                    // Reconnect if we come back to the page
                    initializeConnection();
                }
            });
        });
    </script>
</body>
</html>
