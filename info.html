<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="description" content="Document library for Donald W. Smith Jr.'s portfolio. Access professional documents, certifications, and resources.">
    <meta name="author" content="Donald W. Smith Jr.">
    <meta name="keywords" content="document library, portfolio, certifications, professional documents, resources">
    <meta name="theme-color" content="#ffffff">
    
    <title>Document Library | Donald W. Smith Jr.</title>
    
    <!-- Favicon (base64 encoded to prevent 404) -->
    <link rel="icon" type="image/x-icon" href="data:image/x-icon;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4AkEEjIXDlQhNQAAAB1pVFh0Q29tbWVudAAAAAAAQ3JlYXRlZCB3aXRoIEdJTVBkLmUHAAAAGUlEQVQ4y2NgGAWjYAQBExMTEwPJgAEAHp4B8ZtDqo0AAAAASUVORK5CYII=">
    
    <!-- Preload Critical Resources -->
    <link rel="preload" href="css/styles.css" as="style">
    <link rel="preload" href="css/documents.css" as="style">
    <link rel="preload" href="images/DLogo.jpg" as="image">
    
    <!-- CSS -->
    <link rel="stylesheet" href="css/styles.css" media="all">
    <link rel="stylesheet" href="css/shared-forms.css" media="all">
    <link rel="stylesheet" href="css/documents.css" media="all">
    
    <!-- Preconnect to external domains -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "ItemList",
        "name": "Document Library",
        "description": "Collection of professional documents and resources",
        "itemListOrder": "https://schema.org/ItemListOrderDescending",
        "creator": {
            "@type": "Person",
            "name": "Donald W. Smith Jr."
        }
    }
    </script>
<body>
    <!-- Animated Background -->
    <div class="bg-particles" id="particles"></div>

    <!-- Skip to Main Content Link -->
    <a href="#main-content" class="skip-link">Skip to main content</a>
    
    <!-- Header -->
    <header class="site-header" role="banner">
        <div class="header-content" itemscope itemtype="https://schema.org/Person">
            <a href="index.html" class="logo" aria-label="Return to Home Page" title="Return to Home Page" itemprop="url">
                <img src="images/DLogo.jpg" alt="Donald W. Smith Jr. - Professional Portfolio" class="logo-img" width="50" height="50" loading="lazy" itemprop="image">
            </a>
            
            <!-- Mobile Menu Toggle -->
            <button class="menu-toggle" 
                    id="mobile-menu-toggle" 
                    aria-expanded="false" 
                    aria-controls="primary-navigation"
                    aria-label="Toggle navigation menu">
                <span class="menu-toggle-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Menu</span>
            </button>
            
            <!-- Primary Navigation -->
            <nav id="primary-navigation" class="primary-navigation" aria-label="Primary">
                <ul class="nav-links" role="menubar">
                    <li role="none">
                        <a href="index.html" class="nav-link" title="Navigate to Home Page" aria-label="Home" role="menuitem">
                            <span class="nav-icon" aria-hidden="true">üè†</span>
                            <span class="nav-text">Home</span>
                        </a>
                    </li>
                    <li role="none">
                        <a href="link.html" class="nav-link" title="Request Access Code" aria-label="Request Access Code" role="menuitem">
                            <span class="nav-icon" aria-hidden="true">üîë</span>
                            <span class="nav-text">Request Code</span>
                        </a>
                    </li>
                    <li role="none">
                        <a href="info.html" class="nav-link active" aria-current="page" title="Current Page: Documents" role="menuitem">
                            <span class="nav-icon" aria-hidden="true">üìÇ</span>
                            <span class="nav-text">Documents</span>
                        </a>
                    </li>
                    <li role="none">
                        <a href="about.html" class="nav-link" title="About This Site" aria-label="About" role="menuitem">
                            <span class="nav-icon" aria-hidden="true">‚ÑπÔ∏è</span>
                            <span class="nav-text">About</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </div>
    </header>

    <main id="main-content" role="main" tabindex="-1" itemscope itemtype="https://schema.org/CollectionPage">
        <!-- Login Form Section -->
        <section id="login-section" class="access-code-section" aria-labelledby="login-heading" itemscope itemtype="https://schema.org/WebPageElement">
            <div class="container">
                <div class="access-code-container">
                    <div class="section-header" role="region" aria-labelledby="login-heading login-subtitle">
                        <div class="icon-container" aria-hidden="true">
                            <span class="icon-lock">üîí</span>
                        </div>
                        <h1 id="login-heading" class="section-title fade-in" itemprop="headline">Document Library</h1>
                        <p id="login-subtitle" class="section-subtitle fade-in">Secure access to professional documents</p>
                    </div>
                    
                    <div class="form-container fade-in" role="region" aria-labelledby="login-form-heading">
                        <div class="form-card" itemscope itemtype="https://schema.org/Form">
                            <h2 id="login-form-heading" class="visually-hidden">Document Access Form</h2>
                            
                            <form id="loginForm" class="login-form" novalidate>
                                <div class="form-group" role="group" aria-labelledby="email-label">
                                    <div class="form-field">
                                        <label for="loginEmail" id="email-label" class="form-label">
                                            <span class="label-text">Email Address</span>
                                            <span class="required-indicator" aria-hidden="true">*</span>
                                            <span class="visually-hidden">required</span>
                                        </label>

                                        <div class="input-wrapper">
                                            <input type="email" 
                                                   id="loginEmail" 
                                                   name="email" 
                                                   required 
                                                   autocomplete="email"
                                                   aria-required="true"
                                                   inputmode="email"
                                                   placeholder="your.email@example.com" 
                                                   class="form-input"
                                                   aria-describedby="emailHelp emailError">
                                        </div>
                                        <div id="emailHelp" class="form-hint">Enter the email address associated with your access</div>
                                        <div id="emailError" class="error-message" role="alert" aria-live="polite"></div>
                                    </div>
                                </div>

                                <div class="form-group" role="group" aria-labelledby="code-label">
                                    <div class="form-field">
                                        <label for="accessCode" id="code-label" class="form-label">
                                            <span class="label-text">Access Code</span>
                                            <span class="required-indicator" aria-hidden="true">*</span>
                                            <span class="visually-hidden">required</span>
                                        </label>

                                        <div class="input-wrapper">
                                            <input type="text" 
                                                   id="accessCode" 
                                                   name="accessCode" 
                                                   required 
                                                   inputmode="numeric"
                                                   pattern="\d{6}"
                                                   aria-required="true"
                                                   maxlength="6" 
                                                   placeholder="123456" 
                                                   class="form-input"
                                                   aria-describedby="codeHelp codeError">
                                        </div>
                                        <div id="codeHelp" class="form-hint">Enter the 6-digit code you received</div>
                                        <div id="codeError" class="error-message" role="alert" aria-live="polite"></div>
                                    </div>
                                </div>

                                <div class="form-actions">
                                    <button type="submit" 
                                            class="btn btn-primary btn-block"
                                            aria-label="Sign in to access documents">
                                        <span class="btn-icon" aria-hidden="true">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                                <path d="M5 12h14"></path>
                                                <path d="M12 5l7 7-7 7"></path>
                                            </svg>
                                        </span>
                                        <span class="btn-text">Sign In</span>
                                    </button>
                                </div>
                                
                                <div class="form-footer">
                                    <p>Don't have an access code? <a href="link.html" class="text-link">Request one here</a>.</p>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <!-- Document List Section (initially hidden) -->
        <section id="documents-section" class="section documents-section" aria-labelledby="documents-heading" hidden>
            <div class="documents-header">
                <div class="documents-actions">
                    <button id="signOutBtn" class="btn btn-secondary" aria-label="Sign out">
                        <span class="btn-icon" aria-hidden="true">‚Üê</span>
                        <span class="btn-text">Sign Out</span>
                    </button>
                </div>
            </div>
            <div class="documents-container" role="region" aria-labelledby="documents-heading" tabindex="0">
                <div class="table-responsive">
                    <table id="documentsTable" class="documents-table" aria-describedby="documents-instructions">
                        <caption id="documents-instructions" class="visually-hidden">
                            List of available documents with file names, sizes, and last modified dates.
                            Use the download links to access individual documents.
                        </caption>
                        <thead>
                            <tr>
                                <th scope="col" id="col-filename" class="sortable" data-sort="name" tabindex="0" aria-sort="none">
                                    <span class="th-content">
                                        <span class="th-text">File Name</span>
                                        <span class="sort-indicator" aria-hidden="true"></span>
                                    </span>
                                </th>
                                <th scope="col" id="col-size" class="sortable" data-sort="size" tabindex="0" aria-sort="none">
                                    <span class="th-content">
                                        <span class="th-text">Size</span>
                                        <span class="sort-indicator" aria-hidden="true"></span>
                                    </span>
                                </th>
                                <th scope="col" id="col-modified" class="sortable" data-sort="modified" tabindex="0" aria-sort="none">
                                    <span class="th-content">
                                        <span class="th-text">Last Modified</span>
                                        <span class="sort-indicator" aria-hidden="true"></span>
                                    </span>
                                </th>
                                <th scope="col" id="col-actions" class="actions-col">
                                    <span class="visually-hidden">Actions</span>
                                </th>
                            </tr>
                        </thead>
                        <tbody id="documentsList" aria-live="polite">
                            <!-- Documents will be inserted here by JavaScript -->
                            <tr class="no-documents">
                                <td colspan="4" class="empty-message">
                                    <span class="loading-indicator" aria-hidden="true"></span>
                                    <span>Loading documents...</span>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <div id="emptyState" class="empty-state" role="alert" aria-live="polite" hidden>
                        <div class="empty-state-content">
                            <span class="empty-state-icon" aria-hidden="true">üìÅ</span>
                            <h3>No Documents Found</h3>
                            <p>There are currently no documents available in the files directory.</p>
                            <button id="refreshDocuments" class="btn btn-secondary" aria-label="Refresh document list">
                                <span class="btn-icon" aria-hidden="true">‚ü≥</span>
                                <span class="btn-text">Refresh</span>
                            </button>
                        </div>
                    </div>
                </div>
                

            </div>
        </section>
    </main>

    <!-- Scripts -->
    <script src="js/utils/auth.js"></script>
    <script>
        // Check if user is already authenticated on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Check if auth.js functions are available
            const requiredFunctions = [
                'getAuthData', 'clearAuthData', 'isValidEmail', 
                'verifyDocumentAccess', 'getUserDocuments', 
                'initializeSampleDocuments', 'saveUserDocuments'
            ];
            
            const missingFunctions = requiredFunctions.filter(fn => typeof window[fn] !== 'function');
            
            if (missingFunctions.length > 0) {
                console.error('Missing required functions:', missingFunctions);
                alert('Error: Required scripts not loaded properly. Please open this page through a web server.');
                return;
            }
            const loginSection = document.getElementById('login-section');
            const documentsSection = document.getElementById('documents-section');
            const loginForm = document.getElementById('loginForm');
            const emailInput = document.getElementById('loginEmail');
            const codeInput = document.getElementById('accessCode'); // Updated ID to match HTML
            const requestCodeBtn = document.getElementById('requestCodeBtn');
            const loginBtn = document.getElementById('loginBtn');
            const signOutBtn = document.getElementById('signOutBtn');
            const documentsList = document.getElementById('documentsList');
            const documentCount = document.getElementById('documentCount');
            const lastUpdated = document.getElementById('lastUpdated');
            const uploadForm = document.getElementById('uploadForm');
            const fileInput = document.getElementById('fileInput');
            const uploadBtn = document.getElementById('uploadBtn');
            const searchInput = document.getElementById('searchDocuments');
            const sortSelect = document.getElementById('sortDocuments');
            const filterSelect = document.getElementById('filterDocuments');
            
            let currentUser = null;
            let documents = [];

            // Check authentication status on page load
            function checkAuth() {
                const authData = getAuthData();
                if (authData) {
                    currentUser = authData.email;
                    loadDocuments();
                    showDocumentsSection();
                } else {
                    showLoginSection();
                }
            }

            // Show login section
            function showLoginSection() {
                if (loginSection) loginSection.hidden = false;
                if (documentsSection) documentsSection.hidden = true;
                if (loginForm) loginForm.reset();
            }

            // Show documents section
            function showDocumentsSection() {
                if (loginSection) loginSection.hidden = true;
                if (documentsSection) documentsSection.hidden = false;
                updateDocumentCount();
                updateLastUpdated();
            }

            // Load documents from files directory
            function loadDocuments() {
                if (!currentUser) return;
                
                // List of files in the files directory
                const files = [
                    { 
                        id: 'cover-letter',
                        title: 'Donald Smith Cover Letter',
                        fileType: 'docx',
                        fileSize: '46 KB',
                        uploadDate: new Date().toISOString(),
                        description: 'Professional cover letter',
                        path: 'files/Donald Smith Cover Letter.docx'
                    },
                    { 
                        id: 'resume-ats',
                        title: 'Donald Smith Resume (ATS)',
                        fileType: 'docx',
                        fileSize: '53 KB',
                        uploadDate: new Date().toISOString(),
                        description: 'Resume optimized for ATS systems',
                        path: 'files/Donald Smith Resume ATS.docx'
                    },
                    { 
                        id: 'resume-detail',
                        title: 'Donald Smith Resume (Detailed)',
                        fileType: 'docx',
                        fileSize: '58 KB',
                        uploadDate: new Date().toISOString(),
                        description: 'Comprehensive resume with full work history',
                        path: 'files/Donald Smith Resume Detail.docx'
                    },
                    { 
                        id: 'resume-hr',
                        title: 'Donald Smith Resume (HR)',
                        fileType: 'docx',
                        fileSize: '46 KB',
                        uploadDate: new Date().toISOString(),
                        description: 'Resume tailored for human resources',
                        path: 'files/Donald Smith Resume HR.docx'
                    },
                    { 
                        id: 'resume-short',
                        title: 'Donald Smith Resume (Short)',
                        fileType: 'docx',
                        fileSize: '53 KB',
                        uploadDate: new Date().toISOString(),
                        description: 'Concise one-page resume',
                        path: 'files/Donald Smith Resume Short.docx'
                    },
                    { 
                        id: 'resume-summary',
                        title: 'Donald Smith Resume (Summary)',
                        fileType: 'docx',
                        fileSize: '56 KB',
                        uploadDate: new Date().toISOString(),
                        description: 'Resume with professional summary',
                        path: 'files/Donald Smith Resume Summary.docx'
                    },
                    { 
                        id: 'elevator-speech',
                        title: 'Donald Smith Elevator Speech',
                        fileType: 'docx',
                        fileSize: '13 KB',
                        uploadDate: new Date().toISOString(),
                        description: 'Professional introduction and value proposition',
                        path: 'files/Donald Smith elevator speech.docx'
                    }
                ];
                
                documents = files;
                renderDocuments(documents);
            }

            // Render documents in the UI
            function renderDocuments(docs) {
                if (!documentsList) return;
                
                documentsList.innerHTML = '';
                
                if (docs.length === 0) {
                    documentsList.innerHTML = `
                        <tr>
                            <td colspan="5" class="no-documents">
                                <div class="empty-state">
                                    <span class="icon">üìÅ</span>
                                    <h3>No documents found</h3>
                                    <p>Upload your first document to get started</p>
                                </div>
                            </td>
                        </tr>`;
                    return;
                }
                
                docs.forEach(doc => {
                    const row = document.createElement('tr');
                    row.dataset.id = doc.id;
                    row.innerHTML = `
                        <td class="file-icon">
                            <span class="file-icon" data-type="${doc.fileType}">
                                ${getFileIcon(doc.fileType)}
                            </span>
                        </td>
                        <td class="file-info">
                            <div class="file-name">${escapeHtml(doc.title)}</div>
                            <div class="file-meta">
                                <span class="file-type">${doc.fileType.toUpperCase()}</span>
                                <span class="file-size">${doc.fileSize}</span>
                                <span class="file-date" data-date="${doc.uploadDate}">
                                    Uploaded ${formatDate(doc.uploadDate)}
                                </span>
                            </div>
                        </td>
                        <td class="file-description">${escapeHtml(doc.description)}</td>
                        <td class="file-actions">
                            <button class="btn-icon" title="Download" data-action="download" data-id="${doc.id}">
                                <span class="icon">‚¨áÔ∏è</span>
                            </button>
                        </td>`;
                    documentsList.appendChild(row);
                });
                
                // Add event listeners to action buttons
                documentsList.querySelectorAll('[data-action]').forEach(btn => {
                    btn.addEventListener('click', handleDocumentAction);
                });
            }

            // Handle document download
            function handleDocumentAction(e) {
                const action = e.currentTarget.dataset.action;
                const docId = e.currentTarget.dataset.id;
                const doc = documents.find(d => d.id === docId);
                
                if (!doc || action !== 'download') return;
                
                // Verify user is authenticated before allowing download
                const authData = getAuthData();
                if (!authData || !verifyDocumentAccess(authData.email, authData.code)) {
                    showNotification('Authentication required to download documents', 'error');
                    return;
                }
                
                downloadDocument(doc);
            }

            // Download a document
            function downloadDocument(doc) {
                if (!doc || !doc.path) {
                    showNotification('Error: Invalid document', 'error');
                    return;
                }
                
                // Create a temporary link element
                const link = document.createElement('a');
                link.href = doc.path;
                link.download = doc.title + '.' + doc.fileType;
                
                // Append to the document
                document.body.appendChild(link);
                
                // Trigger the download
                link.click();
                
                // Clean up
                document.body.removeChild(link);
                
                // Show success message
                showNotification(`Downloading ${doc.title}...`, 'success');
                
                // Log the download
                console.log('Downloading document:', doc.title, 'from', doc.path);
                console.log('Downloading document:', doc);
            }

            // Verify document access for download
            function verifyDocumentAccess(email, code) {
                // This is a wrapper around the auth.js function for convenience
                const auth = getAuthData();
                if (!auth || auth.email !== email) return false;
                
                return code === generateAccessCode(email);
            }

            // Update document count
            function updateDocumentCount() {
                if (documentCount) {
                    const count = documents.length;
                    documentCount.textContent = `${count} ${count === 1 ? 'document' : 'documents'}`;
                }
            }

            // Update last updated time
            function updateLastUpdated() {
                if (lastUpdated) {
                    lastUpdated.textContent = `Last updated: ${formatDate(new Date().toISOString())}`;
                }
            }

            // Get file icon based on file type
            function getFileIcon(fileType) {
                const icons = {
                    'pdf': 'üìÑ',
                    'doc': 'üìù',
                    'docx': 'üìù',
                    'xls': 'üìä',
                    'xlsx': 'üìä',
                    'ppt': 'üìë',
                    'pptx': 'üìë',
                    'jpg': 'üñºÔ∏è',
                    'jpeg': 'üñºÔ∏è',
                    'png': 'üñºÔ∏è',
                    'gif': 'üñºÔ∏è',
                    'txt': 'üìÑ',
                    'zip': 'üóúÔ∏è',
                    'rar': 'üóúÔ∏è',
                    'mp3': 'üéµ',
                    'mp4': 'üé¨',
                    'mov': 'üé¨'
                };
                
                return icons[fileType.toLowerCase()] || 'üìÑ';
            }

            // Format date for display
            function formatDate(dateString) {
                const options = { year: 'numeric', month: 'short', day: 'numeric' };
                return new Date(dateString).toLocaleDateString(undefined, options);
            }

            // Escape HTML to prevent XSS
            function escapeHtml(unsafe) {
                if (!unsafe) return '';
                return unsafe
                    .toString()
                    .replace(/&/g, '&amp;')
                    .replace(/</g, '&lt;')
                    .replace(/>/g, '&gt;')
                    .replace(/"/g, '&quot;')
                    .replace(/'/g, '&#039;');
            }

            // Show notification
            function showNotification(message, type = 'info') {
                // In a real app, you might want to implement a proper notification system
                alert(`${type.toUpperCase()}: ${message}`);
            }

            // Handle login form submission
            async function handleLogin(e) {
                e.preventDefault();
                
                const email = emailInput.value.trim();
                const code = codeInput.value.trim();
                
                // Validate inputs
                if (!email || !code) {
                    showNotification('Please fill in all fields', 'error');
                    return;
                }
                
                if (!isValidEmail(email)) {
                    showNotification('Please enter a valid email address', 'error');
                    emailInput.focus();
                    return;
                }
                
                // Verify the code matches the generated one
                const generatedCode = generateAccessCode(email);
                
                if (code === generatedCode) {
                    // Save auth data
                    saveAuthData(email, code);
                    currentUser = email;
                    
                    // Initialize user's documents if they don't exist
                    const userDocs = getUserDocuments(email);
                    if (!userDocs || userDocs.length === 0) {
                        initializeSampleDocuments(email);
                    }
                    
                    showDocumentsSection();
                    loadDocuments();
                    showNotification('Login successful!', 'success');
                } else {
                    showNotification('Invalid access code', 'error');
                    codeInput.focus();
                }
            }

            // Handle logout
            function handleLogout(e) {
                if (e) e.preventDefault();
                clearAuthData();
                currentUser = null;
                documents = [];
                // Force a full page reload to clear any state
                window.location.replace('link.html');
            }

            // Handle request access code
            function handleRequestCode() {
                const email = emailInput.value.trim();
                
                if (!email) {
                    showNotification('Please enter your email address', 'error');
                    emailInput.focus();
                    return;
                }
                
                if (!isValidEmail(email)) {
                    showNotification('Please enter a valid email address', 'error');
                    emailInput.focus();
                    return;
                }
                
                // Generate and display the access code
                const accessCode = generateAccessCode(email);
                
                // In a real app, you would send this code to the user's email
                // For this example, we'll just show it in an alert
                alert(`Your access code is: ${accessCode}\n\n(Note: In a real app, this would be sent to your email)`);
                
                // Enable the code input and login button
                if (codeInput) codeInput.disabled = false;
                if (loginBtn) loginBtn.disabled = false;
                if (codeInput) codeInput.focus();
            }

            // Handle file upload
            function handleFileUpload(e) {
                e.preventDefault();
                
                if (!currentUser) {
                    showNotification('Please log in to upload files', 'error');
                    return;
                }
                
                const file = fileInput?.files?.[0];
                if (!file) {
                    showNotification('Please select a file to upload', 'error');
                    return;
                }
                
                // Create a new document object
                const newDoc = {
                    id: 'doc' + Date.now(),
                    title: file.name.replace(/\.[^/.]+$/, ''), // Remove file extension
                    description: 'Uploaded file',
                    fileName: file.name,
                    fileType: file.name.split('.').pop().toLowerCase(),
                    fileSize: formatFileSize(file.size),
                    uploadDate: new Date().toISOString(),
                    lastModified: new Date(file.lastModified).toISOString()
                };
                
                // Add to documents array
                documents.unshift(newDoc);
                
                // Save to localStorage
                saveUserDocuments(currentUser, documents);
                
                // Update UI
                renderDocuments(documents);
                updateDocumentCount();
                updateLastUpdated();
                
                // Reset the form
                if (uploadForm) uploadForm.reset();
                
                showNotification('File uploaded successfully', 'success');
            }

            // Format file size
            function formatFileSize(bytes) {
                if (bytes === 0) return '0 Bytes';
                const k = 1024;
                const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            }

            // Search documents
            function searchDocuments(query) {
                if (!query.trim()) {
                    renderDocuments(documents);
                    return;
                }
                
                const searchTerm = query.toLowerCase();
                const filtered = documents.filter(doc => 
                    doc.title.toLowerCase().includes(searchTerm) || 
                    doc.description.toLowerCase().includes(searchTerm) ||
                    doc.fileType.toLowerCase().includes(searchTerm)
                );
                
                renderDocuments(filtered);
            }

            // Sort documents
            function sortDocuments(criteria) {
                const sorted = [...documents];
                
                switch (criteria) {
                    case 'name-asc':
                        sorted.sort((a, b) => a.title.localeCompare(b.title));
                        break;
                    case 'name-desc':
                        sorted.sort((a, b) => b.title.localeCompare(a.title));
                        break;
                    case 'date-asc':
                        sorted.sort((a, b) => new Date(a.uploadDate) - new Date(b.uploadDate));
                        break;
                    case 'date-desc':
                        sorted.sort((a, b) => new Date(b.uploadDate) - new Date(a.uploadDate));
                        break;
                    case 'size-asc':
                        sorted.sort((a, b) => parseFloat(a.fileSize) - parseFloat(b.fileSize));
                        break;
                    case 'size-desc':
                        sorted.sort((a, b) => parseFloat(b.fileSize) - parseFloat(a.fileSize));
                        break;
                }
                
                renderDocuments(sorted);
            }

            // Filter documents by type
            function filterDocuments(type) {
                if (!type) {
                    renderDocuments(documents);
                    return;
                }
                
                const filtered = documents.filter(doc => 
                    doc.fileType.toLowerCase() === type.toLowerCase()
                );
                
                renderDocuments(filtered);
            }

            // Event listeners
            if (loginForm) {
                loginForm.addEventListener('submit', handleLogin);
            }
            
            if (requestCodeBtn) {
                requestCodeBtn.addEventListener('click', handleRequestCode);
            }
            
            if (signOutBtn) {
                signOutBtn.addEventListener('click', handleLogout);
            }
            
            if (uploadForm) {
                uploadForm.addEventListener('submit', handleFileUpload);
            }
            
            if (searchInput) {
                searchInput.addEventListener('input', (e) => {
                    searchDocuments(e.target.value);
                });
            }
            
            if (sortSelect) {
                sortSelect.addEventListener('change', (e) => {
                    sortDocuments(e.target.value);
                });
            }
            
            if (filterSelect) {
                filterSelect.addEventListener('change', (e) => {
                    filterDocuments(e.target.value);
                });
            }
            
            // Initialize the app
            checkAuth();
        });
    </script>

    <!-- Footer -->
    <footer id="contact">
        <div class="footer-content">
            <div class="footer-social">
                <a href="https://linkedin.com/in/donaldwsmithjr" class="project-card fade-in" target="_blank" title="LinkedIn">üîó LinkedIn</a>
                <a href="https://github.com/DWSMITHJR" class="project-card fade-in" target="_blank" title="GitHub">üêô GitHub</a> 
                <a href="mailto:architect@donaldwsmithjr.com" class="project-card fade-in" title="Email">üìß Email</a>
            </div>
            <div class="footer-text">
                <p>&copy; 2025 Donald W. Smith Jr. | <a href="privacy.html">Privacy Policy</a> | <a href="terms.html">Terms of Service</a></p>
                <p>Built with passion for innovation | Solving the future, one success after another</p>
            </div>
        </div>
    </footer>
</body>
</html>
